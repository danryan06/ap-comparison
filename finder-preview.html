<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Feature Finder | Enterprise AP Comparison Database</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" type="image/png" href="favicon.png" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="preview-badge-header">PREVIEW MODE</div>
  <header class="site-header">
    <div class="header-content">
      <!-- Logo Section -->
      <div class="header-left">
        <a href="index-preview.html" class="site-logo-link">
          <svg class="logo-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <rect x="2" y="7" width="20" height="14" rx="2" ry="2"/>
            <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/>
            <circle cx="12" cy="14" r="2"/>
          </svg>
          <span class="logo-text">AP Comparison</span>
        </a>
      </div>
      
      <!-- Navigation Section -->
      <nav class="header-nav">
        <a href="index-preview.html" class="nav-link" data-page="index">
          <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="8" y1="6" x2="21" y2="6"/>
            <line x1="8" y1="12" x2="21" y2="12"/>
            <line x1="8" y1="18" x2="21" y2="18"/>
            <line x1="3" y1="6" x2="3.01" y2="6"/>
            <line x1="3" y1="12" x2="3.01" y2="12"/>
            <line x1="3" y1="18" x2="3.01" y2="18"/>
          </svg>
          <span class="nav-text">Browse</span>
        </a>
        
        <a href="finder-preview.html" class="nav-link active" data-page="finder">
          <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="10"/>
            <polygon points="16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76"/>
          </svg>
          <span class="nav-text">Finder</span>
        </a>
        
        <a href="compare-preview.html" class="nav-link" data-page="compare">
          <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M18 20V10"/>
            <path d="M12 20V4"/>
            <path d="M6 20v-6"/>
          </svg>
          <span class="nav-text">Compare</span>
        </a>
        
        <a href="submit.html" class="nav-link nav-link-accent" data-page="submit">
          <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="12" y1="5" x2="12" y2="19"/>
            <line x1="5" y1="12" x2="19" y2="12"/>
          </svg>
          <span class="nav-text">Submit AP</span>
        </a>
      </nav>
      
      <!-- Utility Icons Section -->
      <div class="header-right">
        <!-- Utility Icons -->
        <a href="data_issues.html" class="icon-button" aria-label="Data Quality Dashboard" title="Data Quality">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="18" y1="20" x2="18" y2="10"/>
            <line x1="12" y1="20" x2="12" y2="4"/>
            <line x1="6" y1="20" x2="6" y2="14"/>
          </svg>
        </a>
        
        <a href="https://github.com/danryan06/ap-comparison" target="_blank" rel="noopener noreferrer" class="icon-button" aria-label="View on GitHub" title="GitHub Repository">
          <svg viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 2C6.477 2 2 6.477 2 12c0 4.42 2.865 8.17 6.839 9.49.5.092.682-.217.682-.482 0-.237-.008-.866-.013-1.7-2.782.603-3.369-1.34-3.369-1.34-.454-1.156-1.11-1.463-1.11-1.463-.908-.62.069-.608.069-.608 1.003.07 1.531 1.03 1.531 1.03.892 1.529 2.341 1.087 2.91.831.092-.646.35-1.086.636-1.336-2.22-.253-4.555-1.11-4.555-4.943 0-1.091.39-1.984 1.029-2.683-.103-.253-.446-1.27.098-2.647 0 0 .84-.269 2.75 1.025A9.578 9.578 0 0112 6.836c.85.004 1.705.114 2.504.336 1.909-1.294 2.747-1.025 2.747-1.025.546 1.377.203 2.394.1 2.647.64.699 1.028 1.592 1.028 2.683 0 3.842-2.339 4.687-4.566 4.935.359.309.678.919.678 1.852 0 1.336-.012 2.415-.012 2.743 0 .267.18.578.688.48C19.138 20.167 22 16.418 22 12c0-5.523-4.477-10-10-10z"/>
          </svg>
        </a>
        
        <!-- Button Divider -->
        <div class="header-divider"></div>
        
        <!-- Action Buttons -->
        <a href="edit.html" class="nav-link nav-link-secondary">
          <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
          </svg>
          <span class="nav-text">Edit AP</span>
        </a>
        
        <a href="submit.html" class="nav-link nav-link-accent">
          <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="12" y1="5" x2="12" y2="19"/>
            <line x1="5" y1="12" x2="19" y2="12"/>
          </svg>
          <span class="nav-text">Submit AP</span>
        </a>
      </div>
    </div>
  </header>

  <div class="container" style="margin-top: 24px;">
    <div class="actions">
      <a class="btn-link" href="index-preview.html">Back to Comparison Table</a>
      <a class="btn-link" href="submit.html">Submit New AP</a>
      <button id="clear-filters" type="button" class="btn-link">Reset Filters</button>
      <button id="export-csv" type="button" class="btn-link">Export CSV</button>
    </div>

    <div class="card finder-card">
      <div class="badge">New</div>
      <div class="finder-grid">
        <section class="filter-panel">
          <h2>Filters</h2>

          <div class="filter-group">
            <div class="filter-group-head">
              <h3>Wi-Fi Generation</h3>
            </div>
            <div id="wifi-options" class="chip-grid"></div>
          </div>

          <div class="filter-group">
            <div class="filter-group-head">
              <h3>Vendor</h3>
            </div>
            <div id="vendor-options" class="chip-grid"></div>
          </div>

          <div class="filter-group">
            <div class="filter-group-head">
              <h3>Form Factor</h3>
            </div>
            <div id="form-options" class="chip-grid"></div>
          </div>

          <div class="filter-group">
            <div class="filter-group-head">
              <h3>Antenna Type</h3>
            </div>
            <div id="antenna-options" class="chip-grid"></div>
          </div>
        </section>

        <section class="results-panel">
          <div class="results-header">
            <div>
              <h2>Results</h2>
              <p class="results-note" id="results-note">Loading data…</p>
            </div>
            <div class="match-count" id="match-count">—</div>
          </div>
          <div class="results-counter" id="results-counter" style="display:none;">
            <div class="counter-content">
              <span class="counter-number" id="counter-number">0</span>
              <span class="counter-label">APs match your criteria</span>
            </div>
          </div>

          <div id="active-filters" class="active-filters" style="display:none;"></div>

          <div id="results" class="results-table">
            <div class="result-row result-header">
              <div class="result-cell"></div>
              <div class="result-cell">Vendor</div>
              <div class="result-cell">Model</div>
              <div class="result-cell">Wi-Fi Generation</div>
              <div class="result-cell">Spatial Streams</div>
              <div class="result-cell">Antenna</div>
              <div class="result-cell">Form Factor</div>
              <div class="result-cell">MSRP</div>
              <div class="result-cell"></div>
            </div>
          </div>
          <div id="empty-state" class="empty-state" style="display:none;">
            <p>No APs match every selected requirement.</p>
            <p>Try removing one filter at a time to widen the results.</p>
          </div>
        </section>
      </div>
    </div>
  </div>

  <button id="compare-fab" class="btn-primary floating-compare" style="display:none;" type="button">Compare (0)</button>

  <script>
    const DATA_URL = 'ap_data.json';
    const wifiOptions = [
      { id: 'wifi7', label: 'Wi-Fi 7 (2.4/5/6 GHz)' },
      { id: 'wifi6e', label: 'Wi-Fi 6E (2.4/5/6 GHz)' },
      { id: 'wifi6', label: 'Wi-Fi 6 (2.4/5 GHz)' }
    ];

    const state = {
      wifi: new Set(),
      vendors: new Set(),
      antenna: new Set(),
      form: new Set()
    };

    const selectedIds = new Set(); // For comparison
    let enrichedData = [];


    function restoreFilterStateFromUrl() {
      const params = new URLSearchParams(window.location.search);
      const wifi = params.get('wifi');
      const vendors = params.get('vendors');
      const antenna = params.get('antenna');
      const form = params.get('form');
      
      if (wifi) wifi.split(',').forEach(v => state.wifi.add(v));
      if (vendors) vendors.split(',').forEach(v => state.vendors.add(v));
      if (antenna) antenna.split(',').forEach(v => state.antenna.add(v));
      if (form) form.split(',').forEach(v => state.form.add(v));
    }

    async function loadData() {
      try {
        const res = await fetch(DATA_URL, { cache: 'no-store' });
        if (!res.ok) throw new Error('HTTP ' + res.status);
        const raw = await res.json();
        enrichedData = raw.map(enrichEntry);
        buildFilterOptions();
        restoreFilterStateFromUrl();
        // Update checkboxes to reflect restored state
        document.querySelectorAll('input[data-filter-type]').forEach(input => {
          const type = input.dataset.filterType;
          const value = input.dataset.filterValue;
          const targetSet = state[type];
          if (targetSet && targetSet.has(value)) {
            input.checked = true;
          }
        });
        applyFilters();
      } catch (err) {
        console.error('Failed to load data', err);
        document.getElementById('results-note').textContent = 'Unable to load AP data.';
      }
    }

    function enrichEntry(entry) {
      return Object.assign({}, entry, {
        _slug: slugFor(entry),
        _wifiFlags: deriveWifiFlags(entry.wifi_gen_radios),
        _antennaCategory: deriveAntennaCategory(entry.antenna_type)
      });
    }

    function deriveWifiFlags(value) {
      const flags = new Set();
      const text = String(value || '').toLowerCase();
      if (text.includes('wi-fi 7')) {
        flags.add('wifi7');
        flags.add('wifi6e');
        flags.add('wifi6');
      }
      if (text.includes('wi-fi 6e')) {
        flags.add('wifi6e');
        flags.add('wifi6');
      } else if (text.includes('wi-fi 6')) {
        flags.add('wifi6');
      }
      return flags;
    }

    function deriveAntennaCategory(value) {
      const text = String(value || '').toLowerCase();
      if (!text) return 'Other';
      if (text.includes('internal')) return 'Internal';
      if (text.includes('external')) return 'External';
      if (text.includes('directional')) return 'Directional';
      return 'Other';
    }

    function slugify(value) {
      return String(value || '')
        .toLowerCase()
        .trim()
        .replace(/[^a-z0-9]+/g, '-')
        .replace(/^-+|-+$/g, '');
    }

    function slugFor(entry) {
      return slugify(`${entry.vendor || ''}-${entry.model || ''}`);
    }

    function escapeAttrValue(value) {
      if (window.CSS && typeof window.CSS.escape === 'function') {
        return window.CSS.escape(value);
      }
      return String(value).replace(/"/g, '\\"');
    }

    function buildFilterOptions() {
      renderCheckboxGroup('wifi-options', wifiOptions, 'wifi');

      const vendorOptions = collectUniqueValues('vendor').map(label => ({
        id: slugify(label),
        value: label,
        label
      }));
      renderCheckboxGroup('vendor-options', vendorOptions, 'vendors');

      const formValues = collectUniqueValues('form_factor').map(label => ({
        id: slugify(label),
        value: label,
        label
      }));
      renderCheckboxGroup('form-options', formValues, 'form');

      const antennaValues = Array.from(
        new Set(
          enrichedData
            .map(entry => entry._antennaCategory)
            .filter(label => label && label !== 'Other')
        )
      ).sort();
      const antennaOptions = antennaValues.map(label => ({
        id: slugify(label),
        value: label,
        label
      }));
      renderCheckboxGroup('antenna-options', antennaOptions, 'antenna');

      document.getElementById('results-note').textContent = 'Add filters to see matching APs.';
    }

    function collectUniqueValues(key) {
      const set = new Set();
      enrichedData.forEach(entry => {
        const value = (entry[key] || '').trim();
        if (value) set.add(value);
      });
      return Array.from(set).sort((a, b) => a.localeCompare(b));
    }

    function renderCheckboxGroup(targetId, options, type) {
      const container = document.getElementById(targetId);
      container.innerHTML = '';
      options.forEach(option => {
        const id = `${type}-${option.id || slugify(option.value || option.label)}`;
        const label = document.createElement('label');
        label.className = 'chip-option';
        const input = document.createElement('input');
        input.type = 'checkbox';
        input.id = id;
        input.dataset.filterType = type;
        input.dataset.filterValue = option.value || option.id;
        input.addEventListener('change', () => toggleSelection(type, input.dataset.filterValue, input.checked));
        const span = document.createElement('span');
        span.textContent = option.label;
        label.appendChild(input);
        label.appendChild(span);
        container.appendChild(label);
      });
    }

    function toggleSelection(type, value, checked) {
      const targetSet = state[type];
      if (!targetSet) return;
      if (checked) targetSet.add(value);
      else targetSet.delete(value);
      applyFilters();
    }

    function updateWizardSteps() {
      // Wizard steps removed per user request
    }

    function applyFilters() {
      if (!enrichedData.length) return;
      const matches = enrichedData.filter(entry => matchesFilters(entry));
      renderActiveFilters();
      renderResults(matches);
      updateMatchCount(matches.length);
      updateResultsCounter(matches.length);
      updateWizardSteps();
      document.getElementById('results-note').textContent = matches.length
        ? 'Showing APs that meet every selected requirement.'
        : 'No matches yet — broaden your filters.';
    }

    function updateResultsCounter(count) {
      const counter = document.getElementById('results-counter');
      const counterNumber = document.getElementById('counter-number');
      
      if (count > 0) {
        counter.style.display = 'block';
        // Animate number change
        counterNumber.style.transform = 'scale(1.2)';
        setTimeout(() => {
          counterNumber.textContent = count;
          counterNumber.style.transform = 'scale(1)';
        }, 150);
      } else {
        counter.style.display = 'none';
      }
    }

    function matchesFilters(entry) {
      if (state.wifi.size) {
        for (const need of state.wifi) {
          if (!entry._wifiFlags.has(need)) return false;
        }
      }
      if (state.vendors.size && !state.vendors.has(entry.vendor)) return false;
      if (state.form.size && !state.form.has(entry.form_factor)) return false;
      if (state.antenna.size && !state.antenna.has(entry._antennaCategory)) return false;
      return true;
    }

    function renderResults(matches) {
      const container = document.getElementById('results');
      const emptyState = document.getElementById('empty-state');
      
      // Keep the header row, remove only data rows
      const header = container.querySelector('.result-header');
      container.innerHTML = '';
      if (header) container.appendChild(header);

      if (matches.length === 0) {
        emptyState.style.display = 'block';
        updateCompareFab();
        return;
      }
      emptyState.style.display = 'none';

      matches.forEach(entry => {
        const row = document.createElement('div');
        row.className = 'result-row';

        const checkbox = document.createElement('input');
        checkbox.type = 'checkbox';
        checkbox.className = 'row-select';
        checkbox.checked = selectedIds.has(entry._slug);
        checkbox.addEventListener('click', (e) => {
          e.stopPropagation();
        });
        checkbox.addEventListener('change', () => {
          if (checkbox.checked) selectedIds.add(entry._slug);
          else selectedIds.delete(entry._slug);
          updateCompareFab();
        });

        const vendor = document.createElement('div');
        vendor.className = 'result-cell result-vendor';
        vendor.textContent = entry.vendor || '';

        const model = document.createElement('div');
        model.className = 'result-cell result-model';
        const modelLink = document.createElement('a');
        modelLink.href = `ap.html?id=${encodeURIComponent(entry._slug)}`;
        modelLink.textContent = entry.model || '';
        model.appendChild(modelLink);

        const wifi = document.createElement('div');
        wifi.className = 'result-cell result-wifi';
        wifi.textContent = entry.wifi_gen_radios || '';

        const spatial = document.createElement('div');
        spatial.className = 'result-cell result-spatial';
        spatial.textContent = entry.spatial_streams || '—';

        const antenna = document.createElement('div');
        antenna.className = 'result-cell result-antenna';
        antenna.textContent = entry._antennaCategory || entry.antenna_type || '—';

        const form = document.createElement('div');
        form.className = 'result-cell result-form';
        form.textContent = entry.form_factor || '—';

        const msrp = document.createElement('div');
        msrp.className = 'result-cell result-msrp';
        msrp.textContent = entry.msrp || '—';

        const actions = document.createElement('div');
        actions.className = 'result-cell result-actions';
        const datasheetLink = document.createElement('a');
        if (entry.datasheet_url) {
          datasheetLink.href = entry.datasheet_url;
          datasheetLink.target = '_blank';
          datasheetLink.rel = 'noopener noreferrer';
          datasheetLink.className = 'btn-link btn-link-ghost btn-link-small';
          datasheetLink.textContent = 'Datasheet';
          actions.appendChild(datasheetLink);
        }

        row.appendChild(checkbox);
        row.appendChild(vendor);
        row.appendChild(model);
        row.appendChild(wifi);
        row.appendChild(spatial);
        row.appendChild(antenna);
        row.appendChild(form);
        row.appendChild(msrp);
        row.appendChild(actions);

        // Make entire row clickable (except checkbox)
        row.style.cursor = 'pointer';
        row.addEventListener('click', (e) => {
          if (e.target.type !== 'checkbox' && e.target.tagName !== 'A' && e.target.tagName !== 'BUTTON') {
            const filterState = getFilterStateForUrl();
            const urlParams = new URLSearchParams();
            urlParams.set('id', entry._slug);
            urlParams.set('from', 'finder');
            if (filterState) {
              const filterParams = new URLSearchParams(filterState);
              filterParams.forEach((value, key) => urlParams.set(key, value));
            }
            window.location.href = `ap.html?${urlParams.toString()}`;
          }
        });

        container.appendChild(row);
      });

      updateCompareFab();
    }

    function updateMatchCount(count) {
      const el = document.getElementById('match-count');
      el.textContent = count === 0 ? '0 matches' : `${count} match${count === 1 ? '' : 'es'}`;
    }

    function renderActiveFilters() {
      const container = document.getElementById('active-filters');
      container.innerHTML = '';
      const chips = [];

      function pushChips(type, values, formatter) {
        values.forEach(value => {
          chips.push({
            type,
            value,
            label: formatter ? formatter(value) : value
          });
        });
      }

      pushChips('wifi', state.wifi, value => {
        const option = wifiOptions.find(opt => opt.id === value);
        return option ? option.label : value;
      });
      pushChips('vendors', state.vendors);
      pushChips('antenna', state.antenna);
      pushChips('form', state.form);

      if (!chips.length) {
        container.style.display = 'none';
        return;
      }

      container.style.display = 'flex';
      chips.forEach(chip => {
        const btn = document.createElement('button');
        btn.type = 'button';
        btn.className = 'active-filter-chip';
        btn.textContent = chip.label;
        btn.addEventListener('click', () => removeFilter(chip.type, chip.value));
        container.appendChild(btn);
      });
    }

    function removeFilter(type, value) {
      const set = state[type];
      if (!set) return;
      set.delete(value);
      const selector = `input[data-filter-type="${type}"][data-filter-value="${escapeAttrValue(value)}"]`;
      const input = document.querySelector(selector);
      if (input) input.checked = false;
      applyFilters();
    }

    function clearAllFilters() {
      Object.keys(state).forEach(key => state[key].clear());
      document.querySelectorAll('input[data-filter-type]').forEach(input => {
        input.checked = false;
      });
      selectedIds.clear();
      applyFilters();
    }

    function getFilterStateForUrl() {
      const params = new URLSearchParams();
      if (state.wifi.size) params.set('wifi', Array.from(state.wifi).join(','));
      if (state.vendors.size) params.set('vendors', Array.from(state.vendors).join(','));
      if (state.antenna.size) params.set('antenna', Array.from(state.antenna).join(','));
      if (state.form.size) params.set('form', Array.from(state.form).join(','));
      return params.toString();
    }

    function exportToCsv() {
      if (!enrichedData.length) return;
      const matches = enrichedData.filter(entry => matchesFilters(entry));
      if (matches.length === 0) {
        alert('No APs to export. Please adjust your filters.');
        return;
      }

      const primaryKeys = [
        'vendor','model','wifi_gen_radios','spatial_streams','min_poe_class',
        'recommended_poe','behavior_min_power','ethernet_ports_speed',
        'radios_iot_features','antenna_type','form_factor','dimensions',
        'weight','antenna_connectors','operating_temp_range','msrp','datasheet_url'
      ];

      function escapeCsvValue(value) {
        const s = String(value || '');
        const needsQuotes = /[",\n]/.test(s);
        return needsQuotes ? '"' + s.replace(/"/g, '""') + '"' : s;
      }

      function normalizeString(value) {
        if (value == null) return '';
        if (Array.isArray(value)) return value.join('; ');
        return String(value);
      }

      const keys = Object.keys(matches[0]);
      const orderedKeys = [
        ...primaryKeys.filter(k => keys.includes(k)),
        ...keys.filter(k => !primaryKeys.includes(k)).sort()
      ];

      const headers = orderedKeys.map(k => escapeCsvValue(k));
      const rows = matches.map(entry => {
        return orderedKeys.map(k => {
          const v = entry[k];
          const s = normalizeString(v);
          return escapeCsvValue(s);
        });
      });

      const csv = [headers, ...rows].map(row => row.join(',')).join('\n');
      const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'ap-finder-results.csv';
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }

    function updateCompareFab() {
      const fab = document.getElementById('compare-fab');
      const n = selectedIds.size;
      if (n >= 2) {
        fab.style.display = 'inline-flex';
        fab.textContent = `Compare (${n})`;
      } else {
        fab.style.display = 'none';
      }
    }

    document.addEventListener('DOMContentLoaded', () => {
      // Set active navigation link based on current page
      const currentPage = window.location.pathname.split('/').pop() || 'finder-preview.html';
      const navLinks = document.querySelectorAll('.nav-link');
      
      navLinks.forEach(link => {
        const linkPage = link.getAttribute('data-page');
        if (linkPage === 'finder' && currentPage.includes('finder-preview')) {
          link.classList.add('active');
        } else if (linkPage && currentPage.includes(linkPage + '-preview')) {
          link.classList.add('active');
        }
      });
      
      // Add shadow to header on scroll
      const header = document.querySelector('.site-header');
      let lastScroll = 0;
      
      window.addEventListener('scroll', function() {
        const currentScroll = window.pageYOffset;
        
        if (currentScroll > 10) {
          header.classList.add('scrolled');
        } else {
          header.classList.remove('scrolled');
        }
        
        lastScroll = currentScroll;
      });
      
      document.getElementById('clear-filters').addEventListener('click', clearAllFilters);
      const exportBtn = document.getElementById('export-csv');
      if (exportBtn) {
        exportBtn.addEventListener('click', exportToCsv);
      }
      const compareFab = document.getElementById('compare-fab');
      if (compareFab) {
        compareFab.addEventListener('click', () => {
          if (selectedIds.size < 2) return;
          const idsParam = Array.from(selectedIds).join(',');
          window.location.href = `compare-preview.html?ids=${encodeURIComponent(idsParam)}`;
        });
      }
      loadData();
    });
  </script>
</body>
</html>

